plugins {
    id 'java-gradle-plugin'
    id 'groovy'
}
String xapiHome = "$rootDir.parent/repo"
repositories.jcenter()
repositories.maven {
        name = 'xapiLocal'
        url = xapiHome
//        url = new URI("file://$rootDir.parent/repo")
}
def module = project.dependencies.&create
def local = { path -> project.dependencies.project(path: path) }
def depend = { String key, Object item ->
    if (item instanceof Iterable) {
        for (Object i : item) {
            project.dependencies.add(key, i)
        }
    } else {
        project.dependencies.add(key, item)
    }
}

depend('api', [
        local(':xapi-gradle-api'),
        module("net.wti.core:xapi-gen:$version".toString()),
        module("net.wti.core:xapi-fu:$version".toString()),
        module("net.wti.gradle.tools:xapi-gradle-tools:$version".toString())
])
depend 'compileOnly', [
        project.dependencies.gradleApi(),
        // we'll leave it up to scripts to decide which plugin/version they want to use...
        module('com.jfrog.bintray.gradle:gradle-bintray-plugin:1.8.0'),
        module('org.jfrog.buildinfo:build-info-extractor-gradle:4.8.1'),
        module('com.github.jengelman.gradle.plugins:shadow:4.0.4')
]
depend('testCompile', [
        module('org.spockframework:spock-core:1.2-groovy-2.5'),
        project.dependencies.gradleTestKit()
])
