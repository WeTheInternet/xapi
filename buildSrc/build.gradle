plugins {
    id 'java-library'
    id 'idea'
}
import java.util.concurrent.TimeUnit

String xapiHome = "$rootDir.parent"
apply from: "$rootDir.parent/gradle/xapi-env.gradle"

dependencies {
    api group: 'net.wti.gradle', name: 'xapi-gradle-plugin', version: findProperty('xapiVersion'), changing: true
}

configurations.all {
    Configuration c->
        c.resolutionStrategy.cacheChangingModulesFor(
                gradle.startParameter.rerunTasks ? 0 :
                        (findProperty('cacheTTL') as Integer ?: 60)
                , TimeUnit.MINUTES)
}

if (
    'true' == System.getProperty('xapi.changing') ||
    'true' == findProperty('xapi.changing') ||
    '1' == System.getProperty('xC') ||
    '1' == findProperty('xC')
) {
    apply from: "$xapiHome/gradle/rebuild-tools.gradle"
}