import java.util.concurrent.TimeUnit

plugins {
    id 'java-library'
    id 'groovy'
    id 'idea'
}

repositories {
    jcenter()
    maven {
        name = 'xapiLocal'
        url = new File(rootDir.parentFile, 'repo')
    }
}

dependencies {
    api group: 'net.wti.gradle', name: 'xapi-gradle-plugin', version: '0.5.1', changing: true
    runtime localGroovy()
}

configurations.all {
    Configuration c->
        c.resolutionStrategy.cacheChangingModulesFor(
                gradle.startParameter.rerunTasks ? 0 :
                        (findProperty('cacheTTL') as Integer ?: 60)
                , TimeUnit.MINUTES)
}

if ('true' == System.getProperty('xapi.changing') ||
    'true' == findProperty('xapi.changing')
) {
    apply from: "$rootDir.parent/gradle/rebuild-tools.gradle"
}