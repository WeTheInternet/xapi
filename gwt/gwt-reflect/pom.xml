<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
	<modelVersion>4.0.0</modelVersion>

  <parent>
	  <groupId>net.wetheinter</groupId>
    <artifactId>xapi</artifactId>
  	<version>0.5-SNAPSHOT</version>
  	<relativePath>../../pom.xml</relativePath>
  </parent>

	<groupId>net.wetheinter</groupId>
	<artifactId>gwt-reflect</artifactId>

	<!-- We'll move this to match gwt version upon community approval -->
	<version>2.6.0-SNAPSHOT</version>

	<properties>
        <gwt.skip.test>true</gwt.skip.test>
        <xapi.log.level>INFO</xapi.log.level>
		<maven.compiler.source>1.8</maven.compiler.source>
		<maven.compiler.target>1.8</maven.compiler.target>
    <relative.output>target</relative.output>
	</properties>

	<dependencies>
		<dependency>
			<groupId>net.wetheinter</groupId>
			<artifactId>xapi-dev-source</artifactId>
		</dependency>
		<dependency>
			<groupId>net.wetheinter</groupId>
			<artifactId>gwt-method-inject</artifactId>
		</dependency>
		<dependency>
			<groupId>com.google.gwt</groupId>
			<artifactId>gwt-dev</artifactId>
			<scope>provided</scope>
		</dependency>
		<dependency>
			<groupId>com.google.gwt</groupId>
			<artifactId>gwt-user</artifactId>
			<scope>provided</scope>
		</dependency>
		<dependency>
			<groupId>junit</groupId>
			<artifactId>junit</artifactId>
			<scope>test</scope>
		</dependency>
		<dependency>
			<groupId>junit</groupId>
			<artifactId>junit</artifactId>
            <version>4.11</version><!--$NO-MVN-MAN-VER$-->
			<classifier>sources</classifier>
			<scope>test</scope>
		</dependency>
	</dependencies>

	<build>
    <directory>${project.basedir}/target</directory>
		<resources>
			<resource>
				<directory>src/main/java</directory>
			</resource>
			<resource>
				<directory>src/main/resources</directory>
			</resource>
		</resources>
		<testResources>
			<testResource>
				<directory>src/test/java</directory>
			</testResource>
			<testResource>
				<directory>src/test/resources</directory>
			</testResource>
		</testResources>
		<plugins>
			<plugin>
				<artifactId>maven-clean-plugin</artifactId>
				<version>2.5</version><!--$NO-MVN-MAN-VER$-->
				<executions>
					<execution>
						<id>clean-gwt</id>
						<phase>initialize</phase>
						<goals>
							<goal>clean</goal>
						</goals>
						<configuration>
							<excludeDefaultDirectories>true</excludeDefaultDirectories>
							<filesets>
								<fileset>
									<directory>${project.build.directory}/gwt-gen</directory>
								</fileset>
							</filesets>
						</configuration>
					</execution>
				</executions>
			</plugin>
			<plugin>
				<artifactId>maven-dependency-plugin</artifactId>
				<version>2.8</version>
				<executions>
					<execution>
						<id>unpack</id>
						<phase>generate-sources</phase>
						<goals>
							<goal>unpack</goal>
						</goals>
					</execution>
				</executions>
				<configuration>
					<artifactItems>
						<artifactItem>
							<groupId>com.google.gwt</groupId>
							<artifactId>gwt-user</artifactId>
							<version>${gwt.version}</version>
							<type>jar</type>
							<overWrite>false</overWrite>
							<outputDirectory>${project.build.directory}/gwt-emul</outputDirectory>
							<destFileName>gwt-user.jar</destFileName>
							<includes>com/google/gwt/emul/**/*.java</includes>
						</artifactItem>
						<artifactItem>
							<groupId>com.google.gwt</groupId>
							<artifactId>gwt-dev</artifactId>
							<version>${gwt.version}</version>
							<classifier>sources</classifier>
							<type>jar</type>
							<overWrite>false</overWrite>
							<outputDirectory>${project.build.directory}/gwt-lang</outputDirectory>
							<destFileName>gwt-dev.jar</destFileName>
							<includes>com/google/gwt/dev/jjs/intrinsic/**/*.java</includes>
						</artifactItem>
					</artifactItems>
					<includes>com/google/gwt/**/*.java</includes>
					<outputDirectory>${project.build.directory}/gwt-emul</outputDirectory>
					<overWriteReleases>false</overWriteReleases>
					<overWriteSnapshots>true</overWriteSnapshots>
				</configuration>
			</plugin>

			<plugin>
				<groupId>org.codehaus.mojo</groupId>
				<artifactId>build-helper-maven-plugin</artifactId>
				<version>1.8</version><!--$NO-MVN-MAN-VER$-->
				<executions>
					<execution>
						<id>add-source</id>
						<phase>generate-sources</phase>
						<goals>
							<goal>add-source</goal>
						</goals>
						<inherited>false</inherited>
						<configuration>
							<sources>
								<source>src/main/gwt-${gwt.version}/</source>
								<!--
                                    Uncomment these to look at super-source and/or generated source 
									<source>src/main/resources/com/google/gwt/emul/</source> <source>target/gwt-gen</source> 
									<source>target/gwt-emul/com/google/gwt/emul/</source> <source>target/gwt-lang/com/google/gwt/dev/jjs/intrinsic/</source> -->
							</sources>
						</configuration>
					</execution>
				</executions>
				<goals>
					<goal>add-source</goal>
				</goals>
			</plugin>
			<plugin>
				<artifactId>maven-surefire-plugin</artifactId>
				<version>2.15</version><!--$NO-MVN-MAN-VER$-->
				<configuration>
					<additionalClasspathElements>
						<additionalClasspathElement>${project.build.testSourceDirectory}</additionalClasspathElement>
						<additionalClasspathElement>${project.build.sourceDirectory}</additionalClasspathElement>
					</additionalClasspathElements>
					<useManifestOnlyJar>false</useManifestOnlyJar>
					<forkCount>1</forkCount>
					<reuseForks>false</reuseForks>
					<systemProperties>
						<property>
							<name>gwt.args</name>
							<value>-batch none -precompile all -out
								${project.build.directory}/test-artifacts -war
								${project.build.directory}/www-test -gen
								${project.build.directory}/gwt-gen
								-prod -runStyle HtmlUnit:FF3
                                -userAgents gecko1_8
                                -logLevel ${xapi.log.level}
                                </value>
						</property>
                        <property>
                            <name>gwt.persistentunitcache</name>
                            <value>false</value>
                        </property>
                        <property>
                          <name>gwt.usearchives</name>
                          <value>false</value>
                        </property>
					</systemProperties>
					<skip>${gwt.skip.test}</skip>
				</configuration>
			</plugin>
			<plugin>
				<groupId>org.apache.maven.plugins</groupId>
				<artifactId>maven-eclipse-plugin</artifactId>
				<version>2.8</version>
				<configuration>
					<downloadSources>true</downloadSources>
					<downloadJavadocs>true</downloadJavadocs>
					<buildOutputDirectory>war/WEB-INF/classes</buildOutputDirectory>
					<projectnatures>
						<projectnature>org.eclipse.jdt.core.javanature</projectnature>
						<nature>com.google.gwt.eclipse.core.gwtNature</nature>
						<nature>org.eclipse.m2e.core.maven2Nature</nature>
					</projectnatures>

					<buildcommands>
						<buildcommand>org.eclipse.jdt.core.javabuilder</buildcommand>
						<buildcommand>com.google.gwt.eclipse.core.gwtProjectValidator</buildcommand>
						<buildcommand>org.eclipse.m2e.core.maven2Builder</buildcommand>
					</buildcommands>

					<classpathContainers>
						<classpathContainer>org.eclipse.jdt.launching.JRE_CONTAINER</classpathContainer>
						<classpathContainer>com.google.gwt.eclipse.core.GWT_CONTAINER</classpathContainer>
					</classpathContainers>

				</configuration>
			</plugin>
		</plugins>
		<pluginManagement>
			<plugins>
				<plugin>
					<groupId>net.wetheinter</groupId>
					<artifactId>xapi-maven-plugin</artifactId>
					<configuration>
						<generateDirectory>${project.build.directory}/gwt-gen</generateDirectory>
						<includeTestSource>true</includeTestSource>
						<xapi.log.level>TRACE</xapi.log.level>
					</configuration>
				</plugin>
				<plugin>
					<groupId>org.eclipse.m2e</groupId>
					<artifactId>lifecycle-mapping</artifactId>
					<version>1.0.0</version>
					<configuration>
						<lifecycleMappingMetadata>
							<pluginExecutions>
								<pluginExecution>
									<pluginExecutionFilter>
										<groupId>org.apache.maven.plugins</groupId>
										<artifactId>maven-war-plugin</artifactId>
										<versionRange>[2.0,)</versionRange>
										<goals>
											<goal>exploded</goal>
										</goals>
									</pluginExecutionFilter>
									<action>
										<execute />
									</action>
								</pluginExecution>
								<pluginExecution>
									<pluginExecutionFilter>
										<groupId>org.apache.maven.plugins</groupId>
										<artifactId>maven-dependency-plugin</artifactId>
										<versionRange>[2.0,)</versionRange>
										<goals>
											<goal>unpack</goal>
										</goals>
									</pluginExecutionFilter>
									<action>
										<execute />
									</action>
								</pluginExecution>
								<pluginExecution>
									<pluginExecutionFilter>
										<groupId>org.apache.maven.plugins</groupId>
										<artifactId>maven-clean-plugin</artifactId>
										<versionRange>[2.0,)</versionRange>
										<goals>
											<goal>clean</goal>
										</goals>
									</pluginExecutionFilter>
									<action>
										<execute />
									</action>
								</pluginExecution>
							</pluginExecutions>
						</lifecycleMappingMetadata>
					</configuration>
				</plugin>
				<plugin>
					<groupId>org.apache.maven.plugins</groupId>
					<artifactId>maven-jar-plugin</artifactId>
					<executions>
						<execution>
							<goals>
								<goal>test-jar</goal>
							</goals>
						</execution>
					</executions>
				</plugin>
			</plugins>
		</pluginManagement>
	</build>

	<profiles>
		<profile>
			<id>eclipse</id>
			<activation>
				<property>
					<name>eclipse</name>
				</property>
			</activation>
		</profile>
	</profiles>

</project>
