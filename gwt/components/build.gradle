import net.wti.gradle.schema.api.Transitivity
// only needed for auto-complete support in IDE:
buildscript({
    dependencies {
        classpath "net.wti.gradle.tools:xapi-gradle-tools:$version"
    }
})
plugins {
    id 'xapi-require'
}

sourceSets.getByName('main').java {
    srcDirs 'src/main/java',
            // for now, we'll do this manually.
            'src/main/gen'
}

xapiRequire.main().configure {
    req ->
        req.external "net.wti.core:xapi-lang-core:${->version}", 'main'
        req.project ':gwt-gwtElemental2'
        req.project ':gwt-gwtElemental'
        req.project ':io-jre'
        req.project ':ui:generator'
        req.project ':ui:service-main'
        req.external 'net.wetheinter:gwt-user:2.8.0'
        req.external Transitivity.compile_only, 'net.wetheinter:gwt-dev:2.8.0'
}

xapiRequire.module('test').configure {
    req ->
        req.project ':process-jre'
        req.project ':gwtc-api'
        req.project ':gwtc-compiler'
        req.project ':gwtc-gwtCompiler'
        req.project ':inject-jre'
        req.external 'junit:junit:4.12'
        req.external 'info.cukes:cucumber-java:1.2.5'
        req.external 'info.cukes:cucumber-junit:1.2.5'
        req.external 'org.assertj:assertj-core:3.2.0'
        req.external Transitivity.runtime, 'net.wetheinter:gwt-dev:2.8.0'
}
xapiSchema.whenReady {
    dependencies {
        transitive project(':xapi-dev-parent:xapi-dev-javac')
    }
}
description = 'XApi - Web Component Implementation'

gradle.projectsEvaluated {
    test {
        maxHeapSize = '5G'
    }
}

// tasks.test.dependsOn ':xapi-dev-parent:xapi-dev:xapiPublish'